<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Distilled design documents related to the ROS 2 effort">

    <title>ROS 2 Access Control Policies</title>

    <link rel="icon" type="image/png" href="https://design.ros2.org/favicon.png">

    <link href="ROS2_Access_Control_files/bootstrap.css" rel="stylesheet">
    <link href="ROS2_Access_Control_files/ros2-design.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
    <!-- Google Analytics -->
    <script async="" src="ROS2_Access_Control_files/analytics.js"></script><script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-17821189-13', 'auto');
    ga('send', 'pageview');

    </script>
  </head>

  <body class="vsc-initialized">

  <p style="display: none;" class="github_file">articles/181_ros2_access_control_policies.md</p>

    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="https://design.ros2.org/">ROS 2 Design</a>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li>
              <a href="https://design.ros2.org/contribute.html">Contribute</a>
            </li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <!-- Login is disabled until login mechanism is updated since GitHub deprecated the access_token method: -->
            <!--   https://developer.github.com/changes/2019-11-05-deprecated-passwords-and-authorizations-api/#authenticating-using-query-parameters -->
            <!--
            <a href="https://github.com/login/oauth/authorize?client_id=efa6dd8eae9106381720&amp;scope=read:org"
               class="login-btn btn btn-default navbar-btn">
              <span class="glyphicon glyphicon-user"></span> &nbsp;Login with Github
            </a>
            -->
            <a href="" class="login-btn btn btn-default navbar-btn">
              <span class="glyphicon glyphicon-user"></span> &nbsp;Login disabled for now
            </a>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>

    <div class="container">


<div class="row">
  <div class="content-container col-md-9">
    
<h1 id="ros-2-access-control-policies">ROS 2 Access Control Policies</h1>

<div class="abstract">
  <p>This article specifies the policy format used for access control when securing ROS subsystem.</p>
</div>

<p>Authors: <a href="https://github.com/ruffsl">Ruffin White</a>, <a href="https://github.com/kyrofa">Kyle Fazzari</a></p>

<p>Date Written: 2019-08</p>

<p>Last Modified: 2021-06</p>

<p><a href="https://design.ros2.org/articles/ros2_dds_security.html">SROS 2</a>
 introduces several security properties, including encryption, 
authentication, and authorization.
Authorization is obtained by combining the first two properties with a 
model for access control.
Such models are often referred to as access control policies.
A policy serves as a high-level abstraction of privileges associated 
with attributes that may then be transpiled into low-level permissions 
for individual identities, such as specific ROS nodes within a secure 
DDS network.</p>

<h2 id="concepts">Concepts</h2>

<p>Before detailing the SROS 2 policy design of the <a href="https://en.wikipedia.org/wiki/Computer_access_control">access control</a>,
 by which the system constrains the ability of a subject to access an 
object, it is important to establish a few concepts useful in 
formalizing the design approach in terms of security.
In this setting, a subject may be thought of as a participant on a 
distributed data-bus (e.g. a ROS node in the computation graph), whereas
 an object may be an instance of a particular subsystem (e.g. a ROS 
topic), and access is defined as the capability to act upon that object 
(e.g. publish or subscribe).</p>

<h3 id="mandatory-access-control">Mandatory Access Control</h3>

<p><a href="https://en.wikipedia.org/wiki/Mandatory_access_control">Mandatory Access Control</a>
 (MAC) refers to allowing access to an object if and only if rules exist
 that allow a given subject to access the resource; the term mandatory 
denotes this requirement that a subject’s access to an object must 
always be explicitly provisioned.
Most importantly, contrary to discretionary access control (DAC), such 
policies are enforced by a set of authorization rules that cannot be 
overridden or modified by the subject either accidentally or 
intentionally.
This could also be referred to as “deny by default”.</p>

<h3 id="principle-of-least-privilege">Principle of Least Privilege</h3>

<p><a href="https://en.wikipedia.org/wiki/Principle_of_least_privilege">Principle of Least Privilege</a>
 (PoLP) requires that in a particular abstraction layer, every subject 
must be able to access only the resources necessary for its legitimate 
purpose.
This is also known as the principle of minimal privilege or the 
principle of least authority.
Applying PoLP not only bolsters system security, but can also ease 
deployment and help improve system stability.</p>

<h3 id="privilege-separation">Privilege Separation</h3>

<p><a href="https://en.wikipedia.org/wiki/Privilege_separation">Privilege Separation</a>
 requires that a subject’s access be divided into parts which are 
limited to the specific privileges they require in order to perform a 
specific task.
This is used to mitigate the potential damage of a security 
vulnerability.
Systems unable to comply with this requirement may consequently fail to 
satisfy PoLP as well.</p>

<h3 id="separation-of-concerns">Separation of Concerns</h3>

<p><a href="https://en.wikipedia.org/wiki/Separation_of_concerns">Separation of Concerns</a> (SoC) is a design principle for separating a system into distinct sections, so that each section addresses a separate concern.
Separate concerns in this case may be how encryption is governed in a system versus how authorization is given to subjects.</p>

<h2 id="criteria">Criteria</h2>

<p>Design criteria for SROS 2 policies and for selecting the <a href="https://en.wikipedia.org/wiki/XML">Extensible Markup Language</a> (XML) are discussed here.</p>

<h3 id="validation">Validation</h3>

<p>Prior to interpreting any user configuration input, such as an access control policy, <a href="https://en.wikipedia.org/wiki/Data_validation">data validation</a>
 should be applied to ensure inputs are compliant and correctly 
formatted.
Incorrect inputs can affect the soundness of most programs or tools, yet
 guarding against general malformations may itself require meticulous 
validation logic.
Formalizing the description of the data using a precise schema allows 
for separate programs to assert inputs are compliant without replicating
 validation logic across implementations.
In XML, this is achieved using <a href="https://en.wikipedia.org/wiki/XML_schema">XSD</a>; allowing the policy markup to be defined by an extendable standard definition rather than a canonical implementation.</p>

<h3 id="transformation">Transformation</h3>

<p>For usability and generalizability, access control policies can be 
expressed using domain specific abstractions, such as ROS based subjects
 and objects.
However such abstractions may translate into different representations 
when applied to lower level transports and policy enforcement points.
Formalizing this <a href="https://en.wikipedia.org/wiki/Data_transformation">data transformation</a>
 using a transformation language allows for separate programs to 
transpile without replicating conversion logic across implementations.
In XML, this is achieved using <a href="https://en.wikipedia.org/wiki/XML_transformation_language">XSLT</a>; allowing the policy markup to be easily transpiled for various transports by simply swapping or extending transforms.</p>

<h3 id="composition">Composition</h3>

<p>When formulating an access control policy, many subjects may share fundamental privileges for basic access.
To avoid unnecessary repetition that could exacerbate human errors or other discrepancies, policies should possess sufficient <a href="https://en.wikipedia.org/wiki/Expressive_power_(computer_science)">expressive power</a> to remain <a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself">DRY</a>.
In XML, this is achieved using <a href="https://en.wikipedia.org/wiki/XInclude">XInclude</a>;
 allowing the policy markup to easily include or substitute external 
reference to particular profiles and permissions that repeat across 
separate policies or profiles.</p>

<h2 id="schema">Schema</h2>

<p>The SROS 2 policy schema is defined with XML.
The elements and attributes that make up a policy are described below.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;xs:schema</span>
    <span class="na">xmlns:xs=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span>
    <span class="na">xmlns:xml=</span><span class="s">"http://www.w3.org/XML/1998/namespace"</span>
    <span class="na">elementFormDefault=</span><span class="s">"qualified"</span> <span class="na">attributeFormDefault=</span><span class="s">"unqualified"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;xs:import</span> <span class="na">namespace=</span><span class="s">"http://www.w3.org/XML/1998/namespace"</span>
               <span class="na">schemaLocation=</span><span class="s">"http://www.w3.org/2001/03/xml.xsd"</span> <span class="nt">/&gt;</span>


    <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">"policy"</span> <span class="na">type=</span><span class="s">"Policy"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;xs:complexType</span> <span class="na">name=</span><span class="s">"Policy"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;xs:sequence</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="na">maxOccurs=</span><span class="s">"1"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">"enclaves"</span> <span class="na">type=</span><span class="s">"Enclaves"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/xs:sequence&gt;</span>
        <span class="nt">&lt;xs:attribute</span> <span class="na">name=</span><span class="s">"version"</span> <span class="na">type=</span><span class="s">"xs:string"</span> <span class="na">use=</span><span class="s">"required"</span> <span class="na">fixed=</span><span class="s">"0.2.0"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/xs:complexType&gt;</span>

    <span class="nt">&lt;xs:complexType</span> <span class="na">name=</span><span class="s">"Enclaves"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;xs:sequence</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="na">maxOccurs=</span><span class="s">"unbounded"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">"enclave"</span> <span class="na">type=</span><span class="s">"Enclave"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/xs:sequence&gt;</span>
    <span class="nt">&lt;/xs:complexType&gt;</span>

    <span class="nt">&lt;xs:complexType</span> <span class="na">name=</span><span class="s">"Enclave"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;xs:sequence</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="na">maxOccurs=</span><span class="s">"unbounded"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">"profiles"</span> <span class="na">type=</span><span class="s">"Profiles"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/xs:sequence&gt;</span>
        <span class="nt">&lt;xs:attribute</span> <span class="na">name=</span><span class="s">"path"</span> <span class="na">type=</span><span class="s">"xs:string"</span> <span class="na">use=</span><span class="s">"required"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/xs:complexType&gt;</span>

    <span class="nt">&lt;xs:complexType</span> <span class="na">name=</span><span class="s">"Profiles"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;xs:sequence</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="na">maxOccurs=</span><span class="s">"1"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;xs:sequence</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="na">maxOccurs=</span><span class="s">"unbounded"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">"profile"</span> <span class="na">type=</span><span class="s">"Profile"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/xs:sequence&gt;</span>
            <span class="nt">&lt;xs:sequence</span> <span class="na">minOccurs=</span><span class="s">"0"</span> <span class="na">maxOccurs=</span><span class="s">"1"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">"metadata"</span> <span class="na">type=</span><span class="s">"xs:anyType"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/xs:sequence&gt;</span>
        <span class="nt">&lt;/xs:sequence&gt;</span>
        <span class="nt">&lt;xs:attribute</span> <span class="na">name=</span><span class="s">"type"</span> <span class="na">type=</span><span class="s">"xs:string"</span> <span class="na">use=</span><span class="s">"optional"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/xs:complexType&gt;</span>

    <span class="nt">&lt;xs:complexType</span> <span class="na">name=</span><span class="s">"Profile"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;xs:sequence</span> <span class="na">minOccurs=</span><span class="s">"0"</span> <span class="na">maxOccurs=</span><span class="s">"unbounded"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;xs:choice</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="na">maxOccurs=</span><span class="s">"1"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">"topics"</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="na">type=</span><span class="s">"TopicExpressionList"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">"services"</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="na">type=</span><span class="s">"ServicesExpressionList"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">"actions"</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="na">type=</span><span class="s">"ActionsExpressionList"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/xs:choice&gt;</span>
        <span class="nt">&lt;/xs:sequence&gt;</span>
        <span class="nt">&lt;xs:attribute</span> <span class="na">name=</span><span class="s">"ns"</span> <span class="na">type=</span><span class="s">"xs:string"</span> <span class="na">use=</span><span class="s">"required"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;xs:attribute</span> <span class="na">name=</span><span class="s">"node"</span> <span class="na">type=</span><span class="s">"xs:string"</span> <span class="na">use=</span><span class="s">"required"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;xs:attribute</span> <span class="na">ref=</span><span class="s">"xml:base"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/xs:complexType&gt;</span>

    <span class="nt">&lt;xs:complexType</span> <span class="na">name=</span><span class="s">"TopicExpressionList"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;xs:sequence</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="na">maxOccurs=</span><span class="s">"unbounded"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">"topic"</span> <span class="na">type=</span><span class="s">"Expression"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/xs:sequence&gt;</span>
        <span class="nt">&lt;xs:attribute</span> <span class="na">name=</span><span class="s">"publish"</span> <span class="na">type=</span><span class="s">"RuleQualifier"</span> <span class="na">use=</span><span class="s">"optional"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;xs:attribute</span> <span class="na">name=</span><span class="s">"subscribe"</span> <span class="na">type=</span><span class="s">"RuleQualifier"</span> <span class="na">use=</span><span class="s">"optional"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;xs:attribute</span> <span class="na">ref=</span><span class="s">"xml:base"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/xs:complexType&gt;</span>

    <span class="nt">&lt;xs:complexType</span> <span class="na">name=</span><span class="s">"ServicesExpressionList"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;xs:sequence</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="na">maxOccurs=</span><span class="s">"unbounded"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">"service"</span> <span class="na">type=</span><span class="s">"Expression"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/xs:sequence&gt;</span>
        <span class="nt">&lt;xs:attribute</span> <span class="na">name=</span><span class="s">"reply"</span> <span class="na">type=</span><span class="s">"RuleQualifier"</span> <span class="na">use=</span><span class="s">"optional"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;xs:attribute</span> <span class="na">name=</span><span class="s">"request"</span> <span class="na">type=</span><span class="s">"RuleQualifier"</span> <span class="na">use=</span><span class="s">"optional"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;xs:attribute</span> <span class="na">ref=</span><span class="s">"xml:base"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/xs:complexType&gt;</span>

    <span class="nt">&lt;xs:complexType</span> <span class="na">name=</span><span class="s">"ActionsExpressionList"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;xs:sequence</span> <span class="na">minOccurs=</span><span class="s">"1"</span> <span class="na">maxOccurs=</span><span class="s">"unbounded"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">"action"</span> <span class="na">type=</span><span class="s">"Expression"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/xs:sequence&gt;</span>
        <span class="nt">&lt;xs:attribute</span> <span class="na">name=</span><span class="s">"call"</span> <span class="na">type=</span><span class="s">"RuleQualifier"</span> <span class="na">use=</span><span class="s">"optional"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;xs:attribute</span> <span class="na">name=</span><span class="s">"execute"</span> <span class="na">type=</span><span class="s">"RuleQualifier"</span> <span class="na">use=</span><span class="s">"optional"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;xs:attribute</span> <span class="na">ref=</span><span class="s">"xml:base"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/xs:complexType&gt;</span>

    <span class="nt">&lt;xs:simpleType</span> <span class="na">name=</span><span class="s">"Expression"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;xs:restriction</span> <span class="na">base=</span><span class="s">"xs:string"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/xs:simpleType&gt;</span>

    <span class="nt">&lt;xs:simpleType</span> <span class="na">name=</span><span class="s">"RuleQualifier"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;xs:restriction</span> <span class="na">base=</span><span class="s">"xs:string"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;xs:enumeration</span> <span class="na">value=</span><span class="s">"ALLOW"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;xs:enumeration</span> <span class="na">value=</span><span class="s">"DENY"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/xs:restriction&gt;</span>
    <span class="nt">&lt;/xs:simpleType&gt;</span>

<span class="nt">&lt;/xs:schema&gt;</span>

</code></pre></div></div>

<h3 id="policy-tag"><code class="language-plaintext highlighter-rouge">&lt;policy&gt;</code> Tag</h3>

<p>Root tag of the policy file.
There must be only one <code class="language-plaintext highlighter-rouge">&lt;policy&gt;</code> tag per policy file.</p>

<p>Attributes:</p>
<ul>
  <li><strong>version</strong>: declared version of schema version in use
    <ul>
      <li>Allows for advancing future revisions of the schema</li>
    </ul>
  </li>
</ul>

<h3 id="enclaves-tag"><code class="language-plaintext highlighter-rouge">&lt;enclaves&gt;</code> Tag</h3>

<p>Encapsulates a sequence of unique enclaves.
This method of nesting sequences allows for additional tags to be extended to the <code class="language-plaintext highlighter-rouge">&lt;policy&gt;</code> root.</p>

<h3 id="enclave-tag"><code class="language-plaintext highlighter-rouge">&lt;enclave&gt;</code> Tag</h3>

<p>Encapsulates a collection of profiles.
This is specific to an enclave as determined by associative attributes.</p>

<p>Attributes:</p>
<ul>
  <li><strong>path</strong>: Fully qualified enclave path</li>
</ul>

<p>Given that multiple nodes can be composed into a single process, an 
enclave is used to contain the collection of profiles of all respective 
nodes.
An enclave may therefore be considered the union of contained profiles.
Note that the union of profiles within an enclave will result in denied 
privileges of any profile to supersede all allowed privileges for every 
profile.
E.g. if a profile asks for a permission but a matching permission has 
been explicitly denied by another profile in the enclave, the deny rule 
will take precedence.
See section <code class="language-plaintext highlighter-rouge">&lt;profile&gt;</code> Tag for more info on how MAC is applied.</p>

<h3 id="profiles-tag"><code class="language-plaintext highlighter-rouge">&lt;profiles&gt;</code> Tag</h3>

<p>Encapsulates a sequence of unique profiles and designated metadata.
This method of nesting sequences allows for additional tags to be extended to the <code class="language-plaintext highlighter-rouge">&lt;enclave&gt;</code> root, as well as associating particular metadata or constraints to the contained profile elements.</p>

<p>Attributes:</p>
<ul>
  <li><strong>type</strong>: Specifies the transport type of profiles and metadata</li>
</ul>

<h3 id="profile-tag"><code class="language-plaintext highlighter-rouge">&lt;profile&gt;</code> Tag</h3>

<p>Encapsulates a collection of subject privileges.
This is specific to a unique node instance as determined by associative attributes.</p>

<p>Attributes:</p>
<ul>
  <li><strong>ns</strong>: Namespace of the node</li>
  <li><strong>node</strong>: Name of the node</li>
</ul>

<p>In accordance with MAC, privileges must be explicitly qualified as 
allowed.
Additionally, as with many other MAC languages, while composed 
privileges may overlap, any particular denied privilege will suppress 
any similarly applicable allowed privileges.
That is to say the priority of denied privileges conservatively 
supersedes allowed privileges, avoiding potential lapses in PoLP.
This method of flatting privileges enables users to provision general 
access to a larger set of objects, while simultaneously revoking access 
to a smaller subset of sensitive objects.
Although recursion of qualifiers is subsequently prevented, 
transformations are subsequently simplified, preventing potential for 
unintended access.</p>

<h3 id="metadata-tag"><code class="language-plaintext highlighter-rouge">&lt;metadata&gt;</code> Tag</h3>

<p>Encapsulates arbitrary metadata or constraints.
This could include transport specific permission details applicable to sibling profile elements.
There can only one <code class="language-plaintext highlighter-rouge">metadata</code> element per <code class="language-plaintext highlighter-rouge">profiles</code> parent element.</p>

<p>Attributes:</p>
<ul>
  <li>To be defined</li>
</ul>

<p>Given the use cases for bridge interfaces where an enclave’s 
credentials may be used to interconnect across multiple transports or to
 transport specific domains, it may be necessary to qualify certain 
profile sequences with particular constraints, while doing so multiple 
times for separate profiles per enclave.
This allows advanced users to holistically control the intersect of 
permissions across transport domains, while retaining accurate model 
fidelity of security permissions.
Given how security sensitive bridge interfaces are and the attack 
surface they expose, it is vital that information flow control within a 
bridge remains formally verifiable for safe and secure operation.</p>

<h4 id="privileges">Privileges</h4>

<p>Privileges are defined as configuration of rules and permissions for 
object access.
As objects can be categorized by subsystem type, rules and respective 
permission are identically structured.
Given an average profile is likely to reference more unique objects with
 multiple permissions than number of rules, the subsequent hierarchy of 
rules/permissions/objects is chosen to minimize verbosity.</p>

<table>
  <thead>
    <tr>
      <th>rule types</th>
      <th>permissions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>actions</td>
      <td>call, execute</td>
    </tr>
    <tr>
      <td>services</td>
      <td>reply, request</td>
    </tr>
    <tr>
      <td>topics</td>
      <td>publish, subscribe</td>
    </tr>
  </tbody>
</table>

<p>Each subsystem is associated to a given rule type, while permissions 
are expressed as attributes in their respective respective rule tags.
Uniqueness or ordering of rules in this sequence is not required, as 
this is accounted for by transformation templates.
In fact, a profile may contain an empty set of privileges; particularly 
useful when a node may require no subsystem permissions, but must still 
be provisioned an identity nonetheless for discovery purposes in DDS.</p>

<p>Each rule includes a sequence of objects that the permissions apply.
For some secure transports, such as <a href="https://www.omg.org/spec/DDS-SECURITY/About-DDS-SECURITY">Secure DDS</a>, matching expressions may also be used to expand the scope further using globbing patterns, specifically those supported by <a href="https://pubs.opengroup.org/onlinepubs/9699919799/functions/fnmatch.html">fnmatch</a> as specified in the POSIX standard.
However, caution should be taken when using expression matching, as discussed further in the concerns section.</p>

<p>Basic fnmatch-style patterns are supported:</p>

<table>
  <thead>
    <tr>
      <th>Pattern</th>
      <th>Meaning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>*</td>
      <td>Matches everything</td>
    </tr>
    <tr>
      <td>?</td>
      <td>Matches any single character</td>
    </tr>
    <tr>
      <td>[sequence]</td>
      <td>Matches any character in sequence</td>
    </tr>
    <tr>
      <td>[!sequence]</td>
      <td>Matches any character not in sequence</td>
    </tr>
  </tbody>
</table>

<h3 id="topics-tag"><code class="language-plaintext highlighter-rouge">&lt;topics&gt;</code> Tag</h3>

<p>A group of <code class="language-plaintext highlighter-rouge">&lt;topic&gt;</code> tags with the specified permissions.</p>

<p>Attributes:</p>
<ul>
  <li><strong>publish</strong>: Whether or not publication on this set of topics is allowed
    <ul>
      <li>i.e. whether the node can be a topic publisher</li>
      <li>Valid values are “ALLOW” or “DENY”</li>
    </ul>
  </li>
  <li><strong>subscribe</strong>: Whether or not subscription on this set of topics is allowed
    <ul>
      <li>i.e. whether the node can be a topic subscriber</li>
      <li>Valid values are “ALLOW” or “DENY”</li>
    </ul>
  </li>
</ul>

<h3 id="services-tag"><code class="language-plaintext highlighter-rouge">&lt;services&gt;</code> Tag</h3>

<p>A group of <code class="language-plaintext highlighter-rouge">&lt;service&gt;</code> tags with the specified permissions.</p>

<p>Attributes:</p>
<ul>
  <li><strong>request</strong>: Whether or not requesting the service is allowed
    <ul>
      <li>i.e. whether the node can be a service client</li>
      <li>Valid values are “ALLOW” or “DENY”</li>
    </ul>
  </li>
  <li><strong>reply</strong>: Whether or not replying to service requests is allowed
    <ul>
      <li>i.e. whether the node can be a service server</li>
      <li>Valid values are “ALLOW” or “DENY”</li>
    </ul>
  </li>
</ul>

<h3 id="actions-tag"><code class="language-plaintext highlighter-rouge">&lt;actions&gt;</code> Tag</h3>

<p>A group of <code class="language-plaintext highlighter-rouge">&lt;action&gt;</code> tags with the specified permissions.</p>

<p>Attributes:</p>
<ul>
  <li><strong>call</strong>: Whether or not calling the action is allowed
    <ul>
      <li>i.e. whether the node can be an action client</li>
      <li>Valid values are “ALLOW” or “DENY”</li>
    </ul>
  </li>
  <li><strong>execute</strong>: Whether or not executing the action is allowed
    <ul>
      <li>i.e. whether the node can be an action server</li>
      <li>Valid values are “ALLOW” or “DENY”</li>
    </ul>
  </li>
</ul>

<h2 id="templating">Templating</h2>

<p>To transpile SROS 2 policies into security artifacts for a targeted 
access controlled transport, XSLT templates can be used to perform this 
level of document conversion.
This may include any number of optimisations or adjustments specific for
 the target transport.
For example, the pipeline stages for targeting Secure DDS is as follows:</p>

<ol>
  <li>An XML document with a root of the SROS 2 policy is specified</li>
  <li>The document is fully expanded using XInclude to reference external elements</li>
  <li>The expanded document is then validated with the equivalent schema version</li>
  <li>At this point the document tree may or may not be pruned to a particular profile</li>
  <li>The valid document is then transpiled using the transform template</li>
  <li>For each profile, a matching DDS grant is appended into the permission document
    <ul>
      <li>privileges and namespaces are remapped into a DDS centric representations</li>
      <li>privileges with matching attributes are conjoined to reduce payload size</li>
      <li>duplicate objects in the same privilege are pruned to reduce payload size</li>
      <li>privileges are sorted deny first, abiding the priority of qualifiers when using DDS</li>
      <li>objects are also sorted alphabetically to improve readability and change diffs</li>
    </ul>
  </li>
</ol>

<h2 id="alternatives">Alternatives</h2>

<p>This section lists concerns about the proposed design and alternatives that were considered, including different <a href="https://en.wikipedia.org/wiki/Markup_language">Markup Languages</a> and policy formats.</p>

<h3 id="yaml">YAML</h3>

<p><a href="https://en.wikipedia.org/wiki/YAML">YAML</a>, a recursive 
acronym for “YAML Ain’t Markup Language”, was originally adopted for 
specifying access control policies in the first version of  SROS [1].
Although the policy model used in <a href="http://wiki.ros.org/SROS/Concepts/PolicyDissemination">SROS 1</a>
 was semantically equivalent, the YAML format lent it being quite 
verbose due to repetition of permissions per namespaced resource given 
the lack of clear element attributes.
For SROS 2 we decided switched away from YAML to XML for many of the 
reasons weighed in the following pros and cons:</p>

<ul>
  <li>Pros
    <ul>
      <li>Human Readable: Minimal Line Noise
        <ul>
          <li>YAML has very minimal syntax and is targeted for human 
editable configuration files, making it simple to read and write 
manually.</li>
        </ul>
      </li>
      <li>Data Model: Intuitive Interpretation
        <ul>
          <li>YAML has very simple data model forming tree structure using key-value pair dictionaries and lists making it quite approachable.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Cons
    <ul>
      <li>Parsability: Implicit Type Casting
        <ul>
          <li>Given YAML is a data-serialization language, it may attempt to type cast where possible.
However this does not always have the desired effect and may lead to unintended behaviors.
Parsing of booleans v.s. strings are notable example of ambiguity.</li>
        </ul>
      </li>
      <li>Interpreters: Validation and Transformation
        <ul>
          <li>Although YAML is supported for many programming languages, YAML itself provides no schema to enforce document structure.</li>
          <li>Validation must be repeated for each interpreter implementation, rendering it non-agnostic to the programing language used.</li>
          <li>Similarly, transformations for transpiling policies into 
transport security artifacts is less generalizable across 
implementations.</li>
        </ul>
      </li>
      <li>Composability: Reuse of Profiles
        <ul>
          <li>Although YAML supports a degree of composability via 
Anchors, Aliases and Extensions, allowing documents to be more DRY, 
these do not extend to separate files or external resources.</li>
        </ul>
      </li>
      <li>Expressiveness: Succinct Representation
        <ul>
          <li>Given YAML’s inherit data model, it’s expressive power is 
quite limited, necessitating either verbose file structures, or 
unintuitive options to achieve similar access control configurations.</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h3 id="custom">Custom</h3>

<p>As an alternative to choosing an existing markup format, it would be 
possible to define our own formal language for expressing access control
 permissions for ROS 2 using a custom file syntax.
An example of a MAC based policy language would include that which is 
used in <a href="https://gitlab.com/apparmor/apparmor/wikis/home">AppArmor</a>.
Although affording the flexibility to succinctly express profile 
permission while minimizing general syntactic overhead,  this approach 
was not pursued for many of the reasons weighed in the following pros 
and cons:</p>

<ul>
  <li>Pros
    <ul>
      <li>Expressiveness: Succinct Representation
        <ul>
          <li>Complete control of syntax and interpretation, allowing for domain specific optimizations for SROS policy representation.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Cons
    <ul>
      <li>Interpreters: Validation and Transformation
        <ul>
          <li>Specification and implementation for parsing and interpreting a custom policy format would be considered undertaking.</li>
          <li>Validation must be repeated for each interpreter implementation, rendering it non-agnostic to the programing language used.</li>
          <li>Similarly, transformations for transpiling policies into 
transport security artifacts is less generalizable across 
implementations.</li>
        </ul>
      </li>
      <li>Correctness: Policy Remaining Sound
        <ul>
          <li>Maintaining and synchronizing parsing support across multiple programing language could affect policy soundness.</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h3 id="comarmor">ComArmor</h3>

<p><a href="https://github.com/ComArmor/comarmor">ComArmor</a> [2], a 
predecessor and inspiration for the existing XML ROS 2 policy format now
 used in SROS 2, is itself inspired from AppArmor’s policy language.
ComArmor facilitates composition through the use of a nested tree 
structure of policy/profile/permission primitives.
As with AppArmor, it also supports nesting of profiles, i.e. importation
 of child profiles into that of a parent profile.
While this greatly extends the flexibility given the nesting of imported
 sun-profile hierarchies, it also adds complexity to the transpiling 
process when converting policies to security transport artifacts.</p>

<p>In an effort to strike a balance between simplicity and flexibility, a
 flat sequence of single level profiles was opted for SROS 2 instead, 
allowing the policy format to serve as both a grounded intermediate 
representation for higher level policy languages and tools to build 
upon, such as <a href="https://en.wikipedia.org/wiki/XACML">XACML</a> or <a href="https://github.com/keymint/keymint_tools">Keymint</a>, while remaining succinctly expressive of ROS concepts for general use.</p>

<h2 id="concerns">Concerns</h2>

<h3 id="separation-of-privileges">Separation of Privileges</h3>

<p>ROS 2 subsystems such as topics, services, actions, and parameters 
must eventually map to transport layer interfaces, such as DDS topic, 
that can sufficiently enforce the desired access control policy in order
 to secure the ROS application layer.
However, any quirks between mapping of subsystems and separation of 
privileges can degrade security.</p>

<p>As an example, if granting access to all topics and services starting with <code class="language-plaintext highlighter-rouge">/foo</code> additionally grants access to all actions starting with <code class="language-plaintext highlighter-rouge">/foo</code>, this would be a weak example of privilege separation.
Such can be exacerbated when using globbing expressions that include matching patterns, such as with <code class="language-plaintext highlighter-rouge">fnmatch</code>, leading to innocuous and sound policies being inaccurately applied to the underlying transport security.
While such privilege separation in <a href="https://github.com/ros2/design/pull/203">remains week between ROS 2 and DDS</a>, perhaps it is wise to discourage the use of expression matching for general use in permissions.</p>

<h3 id="separation-of-concerns-1">Separation of Concerns</h3>

<p>Middleware transports, such as DDS, offer a myriad of features and options, such as those for QoS as well as security.
Drawing a boundary between many of them when deciding what to expose from a configuration standpoint can be tricky.
Still, among the objective for ROS 2 includes remaining as agnostic of transport as reasonable.</p>

<p>Although the SROS 2 policy format was intentionally structured to 
mimic that of Secure DDS’s permission.xml format, care should be taken 
when adding extensions to surface non-functional security properties 
tangential to ROS 2 data flow, such as governance on encryption or 
discovery.</p>

<p>Yet, if the intended purpose of SROS 2 policy becomes that of an 
intermediate representation across transports, and is subsequently auto 
generated from higher level tooling/representations, or composability is
 adequate preserved, then perhaps this concern is of lesser priority.</p>

<h3 id="composability">Composability</h3>

<p>ROS 2 allows for the remapping of many namespaced subsystems at 
runtime, such as when reusing launch files to orchestrate larger 
applications.
While it is perhaps unreasonable to expect this dynamic flexibility from
 staticky provisioned permissions without allocating such capabilities 
prior, it should be made possible to infer the necessary capabilities 
from composed launch files and similar orchestrations.</p>

<p>Static analysis of such remapping in conjunction with the setting of 
the nominal requirements of respective nodes could be used to auto 
generate the new satisfactory policies.
However, inferring such policies from the source code could be equated 
to the halting problem.
Thus, it stands to reason nodes could instead provide a manifest or IDL 
defining these nominal requirements so that permission may as easily be 
remapped, at least at design time.</p>

<h2 id="references">References</h2>

<ol>
  <li><a href="https://doi.org/10.1007/978-3-319-91590-6_11">SROS1: Using and Developing Secure ROS1 Systems</a></li>
</ol>

<div class="language-bibtex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">@inbook</span><span class="p">{</span><span class="nl">White2019</span><span class="p">,</span>
	<span class="na">title</span>     <span class="p">=</span> <span class="s">{SROS1: Using and Developing Secure ROS1 Systems}</span><span class="p">,</span>
	<span class="na">author</span>    <span class="p">=</span> <span class="s">{White, Ruffin and Caiazza, Gianluca and Christensen, Henrik and Cortesi, Agostino}</span><span class="p">,</span>
	<span class="na">year</span>      <span class="p">=</span> <span class="m">2019</span><span class="p">,</span>
	<span class="na">booktitle</span> <span class="p">=</span> <span class="s">{Robot Operating System (ROS): The Complete Reference (Volume 3)}</span><span class="p">,</span>
	<span class="na">doi</span>       <span class="p">=</span> <span class="s">{10.1007/978-3-319-91590-6_11}</span><span class="p">,</span>
	<span class="na">isbn</span>      <span class="p">=</span> <span class="s">{978-3-319-91590-6}</span><span class="p">,</span>
	<span class="na">url</span>       <span class="p">=</span> <span class="s">{https://doi.org/10.1007/978-3-319-91590-6_11}</span><span class="p">}</span>
</code></pre></div></div>

<ol>
  <li><a href="https://doi.org/10.1109/IROS.2018.8594462">Procedurally Provisioned Access Control for Robotic Systems</a></li>
</ol>

<div class="language-bibtex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">@inproceedings</span><span class="p">{</span><span class="nl">White2018</span><span class="p">,</span>
	<span class="na">title</span>     <span class="p">=</span> <span class="s">{Procedurally Provisioned Access Control for Robotic Systems}</span><span class="p">,</span>
	<span class="na">author</span>    <span class="p">=</span> <span class="s">{White, Ruffin and Caiazza, Gianluca and Christensen, Henrik and Cortesi, Agostino}</span><span class="p">,</span>
	<span class="na">year</span>      <span class="p">=</span> <span class="m">2018</span><span class="p">,</span>
	<span class="na">booktitle</span> <span class="p">=</span> <span class="s">{2018 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS)}</span><span class="p">,</span>
	<span class="na">doi</span>       <span class="p">=</span> <span class="s">{10.1109/IROS.2018.8594462}</span><span class="p">,</span>
	<span class="na">issn</span>      <span class="p">=</span> <span class="s">{2153-0866}</span><span class="p">,</span>
	<span class="na">url</span>       <span class="p">=</span> <span class="s">{https://doi.org/10.1109/IROS.2018.8594462}</span><span class="p">}</span>
</code></pre></div></div>

  </div>
  <div class="sidebar-container col-md-3">
    <a href="https://github.com/ros2/design/blob/gh-pages/articles/181_ros2_access_control_policies.md" type="button" class="btn btn-default tbmargin">
  <span class="glyphicon glyphicon-file"></span> View Source
</a>

<a href="https://github.com/ros2/design/edit/gh-pages/articles/181_ros2_access_control_policies.md" type="button" class="btn btn-default tbmargin">
  <span class="glyphicon glyphicon-edit"></span> Edit in Github
</a>

<div class="clearfix">&nbsp;</div>

<div class="panel panel-default">
  <div class="panel-heading">Pull Requests</div>
  <ul class="nav nav-pills nav-justified" style="padding: 10px;">
    <li class="open-pr active"><a>Open</a></li>
    <li class="closed-pr"><a>Closed</a></li>
  </ul>

  <!-- Open List group -->
  <div class="open-pr-list pr-list list-group">
    <a href="https://github.com/login/oauth/authorize?client_id=efa6dd8eae9106381720" class="list-group-item">Please Login to View Pull Requests</a>
  </div>

  <!-- Closed List group -->
  <div class="closed-pr-list pr-list list-group" style="display: none;">
    <a href="https://github.com/login/oauth/authorize?client_id=efa6dd8eae9106381720" class="list-group-item">Please Login to View Pull Requests</a>
  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading">Contributors</div>

  <!-- Contributors group -->
  <div class="contributors list-group">
    <a href="https://github.com/login/oauth/authorize?client_id=efa6dd8eae9106381720" class="list-group-item">Please Login to View Contributors</a>
  </div>
</div>

  </div>
</div>

        <span class="clearfix">&nbsp;</span>
        <hr>
        <footer>
            <p class="pull-left">© Open Source Robotics Foundation, Inc.</p>
            <p class="pull-right">Except where otherwise noted, these design documents are licensed under <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0</a>.</p>
        </footer>
    </div><!-- /.container -->

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="ROS2_Access_Control_files/jquery-1.js"></script>
    <script src="ROS2_Access_Control_files/bootstrap.js"></script>
    <script src="ROS2_Access_Control_files/github.js"></script>
    <script src="ROS2_Access_Control_files/ros2-design.js"></script>
  


</body></html>